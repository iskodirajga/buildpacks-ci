resources: ###################################################################################

- name: buildpacks-ci
  type: git
  source:
    uri: {{buildpacks-ci-git-uri-public}}
    branch: test-sample-apps

- name: cf-sample-app-nodejs
  type: git
  source:
    uri: https://github.com/cloudfoundry-samples/cf-sample-app-nodejs.git

jobs: ###################################################################################

- name: cf-sample-app-nodejs-smoke-test
  plan:
    - get: sample-app
      resource: cf-sample-app-nodejs
    - get: buildpacks-ci
    - task: cf-sample-app-nodejs-smoke-test
      file: buildpacks-ci/tasks/sample-app-smoke-test/task.yml
      params:
        BUILDPACK_URL: https://github.com/cloudfoundry/nodejs-buildpack#develop
        APPLICATION_NAME: cf-nodejs
        PATH_TO_GET: "/"
        CF_API: api.run.pivotal.io
        CF_USERNAME: {{pws-username}}
        CF_PASSWORD: {{pws-password}}
        CF_ORGANIZATION: {{pws-org}}
        CF_LOGIN_SPACE: development
        CF_DOMAIN: cfapps.io

groups: ###################################################################################

- name: nodejs-sample-apps
  jobs:
    - cf-sample-app-nodejs-smoke-test
